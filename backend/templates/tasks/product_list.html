{% extends 'main/base.html' %}

{% block title %} All products {% endblock %}

{% block content %}
<form method="get" action="{% url 'product_list' %}">
    <label for="category">Filter by Category:</label>
    <select name="category" id="category">
        <option value="" selected>All Categories</option>
        {% for category in categories %}
            <option value="{{ category.slug }}" {% if category.slug == request.GET.category %}selected{% endif %}>{{ category.name }}</option>
        {% endfor %}
    </select>

    <label for="in_stock">In Stock:</label>
    <input type="checkbox" name="in_stock" {% if request.GET.in_stock %}checked{% endif %}>

    <button type="submit">Filter</button>
</form>

<form method="get" action="{% url 'product_list' %}">
    {{ search }}
    <button type="submit">Search</button>
</form>

{% for product in products %}
    <div>
        <h2>{{ product.name }}</h2>
        <p>Category: {{ product.cat.name }}</p>
        <p>Price: {{ product.price }}</p>
        <p>In Stock: {% if product.in_stock %}Yes{% else %}No{% endif %}</p>
        <a href="{% url 'product_detail' pk=product.pk %}">Details</a>
    </div>
{% endfor %}

<div class="pagination">
    <span class="step-links">
        {% if products.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ products.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ products.number }} of {{ products.paginator.num_pages }}.
        </span>

        {% if products.has_next %}
            <a href="?page={{ products.next_page_number }}">next</a>
            <a href="?page={{ products.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
</div>
{% endblock %}
